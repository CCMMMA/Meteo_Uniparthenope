<Page loaded="pageLoaded" class="page" xmlns="http://www.nativescript.org/tns.xsd" xmlns:chart="nativescript-ui-chart"  xmlns:dd="nativescript-drop-down" xmlns:flv="nativescript-folding-list-view">
    <ActionBar class="blue_background_action_bar" flat="true">
        <Label text="{{ titolo }}" fontSize="20"></Label>
    </ActionBar>

    <ScrollView height="100%">
        <StackLayout orientation="vertical" verticalAlignment="top" margin="10 10 10 10">
            <ActivityIndicator class="activity-indicator" busy="{{ isBusy_meteo }}" height="{{isHeigh_meteo}}" />
            <StackLayout class="blue_background_opac" visibility="{{ meteo }}">
                <FlexboxLayout flexWrap="wrap" flexDirection="row" margin="10 10 5 10">
                    <Label text="TEMPERATURA:" verticalAlignment="center" style="font-weight:bold; flex-grow:1" />
                    <Label text="{{ temperatura }}" verticalAlignment="center" style="font-weight:bold;"/>
                </FlexboxLayout>

                <FlexboxLayout flexWrap="wrap" flexDirection="row" marginTop="20" margin="5 10 5 10">
                    <Label text="METEO:" verticalAlignment="center" style="font-weight:bold; flex-grow:1" />
                    <Label text="{{ _meteo }}" verticalAlignment="center" style="font-weight:bold;"/>
                </FlexboxLayout>

                <FlexboxLayout flexWrap="wrap" flexDirection="row" marginTop="20" margin="5 10 5 10">
                    <Label text="NUVOLOSITÀ:" verticalAlignment="center" style="font-weight:bold; flex-grow:1" />
                    <Label text="{{ cloud }}" verticalAlignment="center" style="font-weight:bold;"/>
                </FlexboxLayout>

                <FlexboxLayout flexWrap="wrap" flexDirection="row" marginTop="20" margin="5 10 5 10">
                    <Label text="UMIDITÀ:" verticalAlignment="center" style="font-weight:bold; flex-grow:1" />
                    <Label text="{{ humidity }}" verticalAlignment="center" style="font-weight:bold;"/>
                </FlexboxLayout>

                <FlexboxLayout flexWrap="wrap" flexDirection="row" marginTop="20" margin="5 10 5 10">
                    <Label text="PRESSIONE:" verticalAlignment="center" style="font-weight:bold; flex-grow:1" />
                    <Label text="{{ pressione }}" verticalAlignment="center" style="font-weight:bold;"/>
                </FlexboxLayout>

                <FlexboxLayout flexWrap="wrap" flexDirection="row" marginTop="20" margin="5 10 5 10">
                    <Label text="DIREZIONE VENTO:" verticalAlignment="center" style="font-weight:bold; flex-grow:1" />
                    <Label text="{{ wind_direction }}" verticalAlignment="center" style="font-weight:bold;"/>
                </FlexboxLayout>

                <FlexboxLayout flexWrap="wrap" flexDirection="row" marginTop="20" margin="5 10 5 10">
                    <Label text="VELOCITÀ VENTO:" verticalAlignment="center" style="font-weight:bold; flex-grow:1" />
                    <Label text="{{ wind_speed }}" verticalAlignment="center" style="font-weight:bold;"/>
                </FlexboxLayout>

                <FlexboxLayout flexWrap="wrap" flexDirection="row" marginTop="20" margin="5 10 5 10">
                    <Label text="TEMPERATURA PERCEPITA:" verticalAlignment="center" style="font-weight:bold; flex-grow:1" />
                    <Label text="{{ wind_chill }}" verticalAlignment="center" style="font-weight:bold;"/>
                </FlexboxLayout>

                <FlexboxLayout flexWrap="wrap" flexDirection="row" marginTop="20" margin="5 10 10 10">
                    <Label text="VENTO:" verticalAlignment="center" style="font-weight:bold; flex-grow:1" />
                    <Label text="{{ wind }}" verticalAlignment="center" style="font-weight:bold;"/>
                </FlexboxLayout>
            </StackLayout>

            <ActivityIndicator class="activity-indicator" busy="{{ isBusy }}" height="{{isHeigh}}" />
            <StackLayout class="blue_background_opac" marginTop="20" visibility="{{ table }}">
                <FlexboxLayout flexDirection="row">
                    <!-- Use even flexGrow to achieve uniform grid -->
                    <Label flexGrow="1" class="font-weight-bold text-center" text="Forecast" width="40%"/>
                    <StackLayout flexGrow="1" class="font-weight-bold text-center" width="15%">
                        <Label text="T Min"/>
                        <Label text="(°C)"></Label>
                    </StackLayout>
                    <StackLayout flexGrow="1" class="font-weight-bold text-center" width="15%">
                        <Label text="T Max"/>
                        <Label text="(°C)"></Label>
                    </StackLayout>
                    <StackLayout flexGrow="1" class="font-weight-bold text-center" width="15%">
                        <Label text="Vento"/>
                        <Label text="(Kn)"></Label>
                    </StackLayout>
                    <StackLayout flexGrow="1" class="font-weight-bold text-center" width="15%">
                        <Label text="Pioggia"/>
                        <Label text="(mm)"></Label>
                    </StackLayout>
                </FlexboxLayout>

                <ListView items="{{ statistic }}" itemTap="onTap" orientation="vertical" marginTop="10" height="{{ altezza }}" margin="10 5 5 5">
                    <ListView.itemTemplate>
                        <FlexboxLayout flexDirection="row">
                            <StackLayout flexGrow="1" class="font-weight-bold text-center" width="40%">
                                <Label text="{{ forecast }}"/>
                                <Image src="{{ image }}" height="25" width="15"></Image>
                            </StackLayout>
                            <Label text="{{ TMin }}" flexGrow="1" class="font-weight-bold text-center" width="15%"/>
                            <Label text="{{ TMax }}" flexGrow="1" class="font-weight-bold text-center" width="15%"/>
                            <Label text="{{ Wind }}" flexGrow="1" class="font-weight-bold text-center" width="15%" textWrap="true"/>
                            <Label text="{{ Rain }}" flexGrow="1" class="font-weight-bold text-center" width="15%"/>
                        </FlexboxLayout>
                    </ListView.itemTemplate>
                </ListView>
            </StackLayout>

            <StackLayout orientation="vertical" marginTop="20">
                <StackLayout margin="5 5 5 5">
                    <dd:DropDown
                            items="{{ products }}" selectedIndex="{{ selectedIndex }}"
                            hint = "{{ hint_prod }}"
                            selectedValue = "{{ selectedValue }}"
                                 opened="dropDownOpened" closed="dropDownClosed"
                                 selectedIndexChanged="dropDownSelectedIndexChanged"
                                 row="0" colSpan="2" />
                </StackLayout>

                <StackLayout margin="5 5 5 5">
                    <dd:DropDown items="{{ outputs }}" selectedIndex="{{ selectedIndex1 }}"
                                 hint="{{ hint_output }}"
                                 opened="dropDownOpened1" closed="dropDownClosed1"
                                 selectedIndexChanged="dropDownSelectedIndexChanged1"
                                 row="0" colSpan="2" />
                </StackLayout>
            </StackLayout>

            <ActivityIndicator class="activity-indicator" busy="{{ isBusy_map }}" height="{{isHeigh_map}}" />
            <StackLayout margin="20 10 15 10" class="blue_background" horizontalAlignment="center" row="0" col="0" verticalAlignment="bottom" orientation="horizontal" height="50">
                <Image horizontalAlignment="left" src="~/images/back.png" height="25" margin="10 40 10 10" tap="onTapBack"></Image>
                <Label verticalAlignment="center" text="{{ data }}"  tap="toggleDrawer"></Label>
                <Image horizontalAlignment="right" src="~/images/next.png" height="25" margin="10 10 10 40" tap="onTapNext"></Image>
            </StackLayout>
            <Image src="{{ map }}" marginTop="10" visibility="{{ _map }}"/>


            <StackLayout margin="5 5 5 5">
                <Label text="Aggregazione: "></Label>
                <dd:DropDown items="{{ steps }}" selectedIndex="{{ selectedIndex2 }}"
                             hint="{{ hint_steps }}"
                             opened="dropDownOpened2" closed="dropDownClosed2"
                             selectedIndexChanged="dropDownSelectedIndexChanged2"
                             row="0" colSpan="2" />

                <StackLayout orientation="vertical" visibility="{{ hours_visibility }}">
                    <Label text="Ore"></Label>
                    <dd:DropDown items="{{ hours }}" selectedIndex="{{ selectedIndex3 }}"
                                 hint="{{ hint_hours }}"
                                 opened="dropDownOpened3" closed="dropDownClosed3"
                                 selectedIndexChanged="dropDownSelectedIndexChanged3"
                                 row="0" colSpan="2" />
                </StackLayout>

                <ActivityIndicator  class="activity-indicator" busy="{{ isBusy_graphic }}" height="{{isHeigh_graphic}}" />
                <chart:RadCartesianChart height="350" marginTop="20" seriesSelectionMode="Multiple" visibility="{{ graphic }}">
                    <chart:RadCartesianChart.series>
                        <chart:BarSeries
                                seriesName="1"
                                legendTitle="{{ title_1 }}"
                                items="{{ temp }}"
                                categoryProperty="key"
                                valueProperty="val"
                                showLabels="false">
                            <chart:BarSeries.labelStyle>
                                <chart:BarSeriesStyle margin="10" fontStyle="Bold"/>
                            </chart:BarSeries.labelStyle>
                            <chart:BarSeries.horizontalAxis>
                                <chart:CategoricalAxis labelFitMode="Rotate"  height="0"  labelTextColor="rgba(30,76,117,1)"/>
                            </chart:BarSeries.horizontalAxis>
                            <chart:BarSeries.verticalAxis>
                                <chart:LinearAxis  labelFormat="%.0f" labelTextColor="rgba(30,76,117,1)"/>
                            </chart:BarSeries.verticalAxis>
                        </chart:BarSeries>
                        <chart:LineSeries
                                seriesName="2"
                                legendTitle="{{ title_2 }}"
                                items="{{ press }}"
                                categoryProperty="key"
                                valueProperty="val"
                                showLabels="false">
                            <chart:LineSeries.labelStyle>
                                <chart:LineSeriesStyle margin="10" fontStyle="Bold"/>
                            </chart:LineSeries.labelStyle>
                            <chart:LineSeries.horizontalAxis>
                                <chart:CategoricalAxis labelFitMode="Rotate" height="0" hidden="true" verticalLocation="Down" zPosition="0"/>
                            </chart:LineSeries.horizontalAxis>
                            <chart:LineSeries.verticalAxis>
                                <chart:LinearAxis horizontalLocation="Right" labelFormat="%.0f" labelTextColor="rgba(30,76,117,1)"/>
                            </chart:LineSeries.verticalAxis>
                        </chart:LineSeries>
                    </chart:RadCartesianChart.series>

                    <chart:RadCartesianChart.legend>
                        <chart:RadLegendView position="Top" enableSelection="true"/>
                    </chart:RadCartesianChart.legend>

                    <chart:RadCartesianChart.palettes>
                        <chart:Palette seriesName="1">
                            <chart:Palette.entries>
                                <chart:PaletteEntry fillColor="rgba(117,145,167,1)" strokeColor="rgba(117,145,167,1)"/>
                            </chart:Palette.entries>
                        </chart:Palette>

                        <chart:Palette seriesName="2">
                            <chart:Palette.entries>
                                <chart:PaletteEntry
                                        android:fillColor="rgba(30,76,117,1)"
                                        ios:fillColor="rgba(30,76,117,1)"
                                        strokeColor="rgba(30,76,117,1)" strokeWidth="3"
                                        android:strokeWidth="6" />
                            </chart:Palette.entries>
                        </chart:Palette>
                    </chart:RadCartesianChart.palettes>
                </chart:RadCartesianChart>
            </StackLayout>

            <ActivityIndicator  class="activity-indicator" busy="{{ isBusy_graphic1 }}" height="{{isHeigh_graphic1}}" />
            <chart:RadCartesianChart height="350" marginTop="20" visibility="{{ graphic1 }}">
                <chart:RadCartesianChart.series>
                    <chart:BarSeries
                            seriesName="1"
                            legendTitle="{{ title_s }}"
                            items="{{ single_item }}"
                            categoryProperty="key"
                            valueProperty="val"
                            showLabels="true">
                        <chart:BarSeries.labelStyle>
                            <chart:BarSeriesStyle margin="10" fontStyle="Bold"/>
                        </chart:BarSeries.labelStyle>
                        <chart:BarSeries.horizontalAxis>
                            <chart:CategoricalAxis labelFitMode="Rotate"  height="0" labelTextColor="rgba(30,76,117,1)"/>
                        </chart:BarSeries.horizontalAxis>
                        <chart:BarSeries.verticalAxis>
                            <chart:LinearAxis  labelFormat="%.0f" labelTextColor="rgba(30,76,117,1)"/>
                        </chart:BarSeries.verticalAxis>
                    </chart:BarSeries>
                </chart:RadCartesianChart.series>

                <chart:RadCartesianChart.legend>
                    <chart:RadLegendView position="Top" enableSelection="true"/>
                </chart:RadCartesianChart.legend>

                <chart:RadCartesianChart.palettes>
                    <chart:Palette seriesName="1">
                        <chart:Palette.entries>
                            <chart:PaletteEntry fillColor="rgba(117,145,167,1)" strokeColor="rgba(117,145,167,1)"/>
                        </chart:Palette.entries>
                    </chart:Palette>
                </chart:RadCartesianChart.palettes>
            </chart:RadCartesianChart>

            <GridLayout>
                <flv:FoldingListView items="{{ item }}" foldsCount="5" foldedRowHeight="95"
                                     detailDataLoader="detailDataLoader">
                    <flv:FoldingListView.foregroundItemTemplate>
                        <GridLayout columns="75, *" class="folded-cell">
                            <GridLayout row="0" col="0" rows="*, auto, auto, *" class="item-nbr">
                                <Label row="1" text="Item"/>
                                <Label row="2" text="{{ '#' + item }}"/>
                            </GridLayout>
                            <StackLayout col="1" padding="10">
                                <Label class="h2" text="My Header"/>
                                <Label class="label" textWrap="true" text="Short description. Tap to see more!"/>
                            </StackLayout>
                        </GridLayout>
                    </flv:FoldingListView.foregroundItemTemplate>

                    <flv:FoldingListView.containerItemTemplate>
                        <StackLayout rows="auto, *, auto" class="expanded-cell">
                            <Label class="item-nbr" text="{{ 'Item #' + item }}" />
                            <Label class="label" textWrap="true" text="{{ details }}" />
                            <Button id="btn" class="btn btn-primary" text="Click Me!" />
                        </StackLayout>
                    </flv:FoldingListView.containerItemTemplate>
                </flv:FoldingListView>
            </GridLayout>

        </StackLayout>
    </ScrollView>
</Page>